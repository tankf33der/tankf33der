# lets rewrite elligator.sage on PicoLisp
(setq
   *P (- (** 2 255) 19)
)
(de %% (X Y)
   (% (+ Y (% X Y)) Y) )
(de exp (A, B)
   (let D 1
      (for I (chop (bin B))
         (setq D (%% (* D D) *P))
         (and
            (= "1" I)
            (setq D (%% (* D A) *P)) ) )
      D ) )
(de invert (N)
   (exp N (- *P 2)) )
(de m_abs (N)
   (let M (%% N *P)
      (if (>= (/ (dec *P) 2) M)
         M
         (%% (- M) *P) ) ) )
(test
   1234567
   (m_abs 1234567) )
(test
   0
   (m_abs *P) )
(test
   123456774577567895678956568989457894574578945789457894545789
   (m_abs -123456774577567895678956568989457894574578945789457894545789) )
(test
   0
   (invert *P) )
(test
   40903448833803765304030505711834176292329494422674962581796698797273844702493
   (invert 45454545768457684576845765) )
(test
   926549609804623448265268294182900512918058893428212027689876489708283
   (exp 123 33) )
(test
   43579178365488290487999733433133644729453586639746054162384555965744964322950
   (exp 3244545454537834663434343434 10000000000000000000) )


(msg 'ok)
(bye)
