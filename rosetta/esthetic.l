(de esthetic (N Base)
   (let Lst
      (make
         (loop
            (yoke (% N Base))
            (T (=0 (setq N (/ N Base)))) ) )
      (and
         (fully
            =1
            (make
               (for (L Lst (cdr L) (cdr L))
                  (link (abs (- (car L) (cadr L)))) ) ) )
         (pack
            (mapcar
               '((C)
                  (and (> C 9) (inc 'C 39))
                  (char (+ C 48)) )
               Lst ) ) ) ) )
(de genCount (Num Base)
   (let (C 0  N 0)
      (tail
         (inc (* 2 Base))
         (make
            (while (>= Num C)
               (when (esthetic N Base) (link @) (inc 'C))
               (inc 'N) ) ) ) ) )
(de genRange (A B Base)
   (make
      (while (>= B A)
         (when (esthetic A Base) (link @))
         (inc 'A) ) ) )
(for (N 2 (>= 16 N) (inc N))
   (prin "Base " N ": ")
   (mapc '((L) (prin L " ")) (genCount (* 6 N) N))
   (prinl) )
(prinl)
(prinl "Base 10: 61 esthetic numbers between 1000 and 9999:")
(let L (genRange 1000 9999 10)
   (while (cut 16 'L)
      (mapc '((L) (prin L " ")) @)
      (prinl) ) )
(prinl)
(prinl "Base 10: 126 esthetic numbers between 100000000 and 130000000:")
(let L (genRange 100000000 130000000 10)
   (while (cut 9 'L)
      (mapc '((L) (prin L " ")) @)
      (prinl) ) )

(msg 'ok)
(bye)

#{
Base 2: 10101010 101010101 1010101010 10101010101 101010101010
Base 3: 1210 1212 2101 2121 10101 10121 12101
Base 4: 323 1010 1012 1210 1212 1232 2101 2121 2123
Base 5: 323 343 432 434 1010 1012 1210 1212 1232 1234 2101
Base 6: 343 345 432 434 454 543 545 1010 1012 1210 1212 1232 1234
Base 7: 345 432 434 454 456 543 545 565 654 656 1010 1012 1210 1212 1232
Base 8: 432 434 454 456 543 545 565 567 654 656 676 765 767 1010 1012 1210 1212
Base 9: 434 454 456 543 545 565 567 654 656 676 678 765 767 787 876 878 1010 1012 1210
Base 10: 454 456 543 545 565 567 654 656 676 678 765 767 787 789 876 878 898 987 989 1010 1012
Base 11: 456 543 545 565 567 654 656 676 678 765 767 787 789 876 878 898 89a 987 989 9a9 a98 a9a 1010
Base 12: 543 545 565 567 654 656 676 678 765 767 787 789 876 878 898 89a 987 989 9a9 9ab a98 a9a aba ba9 bab
Base 13: 545 565 567 654 656 676 678 765 767 787 789 876 878 898 89a 987 989 9a9 9ab a98 a9a aba abc ba9 bab bcb cba
Base 14: 565 567 654 656 676 678 765 767 787 789 876 878 898 89a 987 989 9a9 9ab a98 a9a aba abc ba9 bab bcb bcd cba cbc cdc
Base 15: 567 654 656 676 678 765 767 787 789 876 878 898 89a 987 989 9a9 9ab a98 a9a aba abc ba9 bab bcb bcd cba cbc cdc cde dcb dcd
Base 16: 654 656 676 678 765 767 787 789 876 878 898 89a 987 989 9a9 9ab a98 a9a aba abc ba9 bab bcb bcd cba cbc cdc cde dcb dcd ded def edc

Base 10: 61 esthetic numbers between 1000 and 9999:
1010 1012 1210 1212 1232 1234 2101 2121 2123 2321 2323 2343 2345 3210 3212 3232
3234 3432 3434 3454 3456 4321 4323 4343 4345 4543 4545 4565 4567 5432 5434 5454
5456 5654 5656 5676 5678 6543 6545 6565 6567 6765 6767 6787 6789 7654 7656 7676
7678 7876 7878 7898 8765 8767 8787 8789 8987 8989 9876 9878 9898

Base 10: 126 esthetic numbers between 100000000 and 130000000:
101010101 101010121 101010123 101012101 101012121 101012123 101012321 101012323 101012343
101012345 101210101 101210121 101210123 101212101 101212121 101212123 101212321 101212323
101212343 101212345 101232101 101232121 101232123 101232321 101232323 101232343 101232345
101234321 101234323 101234343 101234345 101234543 101234545 101234565 101234567 121010101
121010121 121010123 121012101 121012121 121012123 121012321 121012323 121012343 121012345
121210101 121210121 121210123 121212101 121212121 121212123 121212321 121212323 121212343
121212345 121232101 121232121 121232123 121232321 121232323 121232343 121232345 121234321
121234323 121234343 121234345 121234543 121234545 121234565 121234567 123210101 123210121
123210123 123212101 123212121 123212123 123212321 123212323 123212343 123212345 123232101
123232121 123232123 123232321 123232323 123232343 123232345 123234321 123234323 123234343
123234345 123234543 123234545 123234565 123234567 123432101 123432121 123432123 123432321
123432323 123432343 123432345 123434321 123434323 123434343 123434345 123434543 123434545
123434565 123434567 123454321 123454323 123454343 123454345 123454543 123454545 123454565
123454567 123456543 123456545 123456565 123456567 123456765 123456767 123456787 123456789
}#
